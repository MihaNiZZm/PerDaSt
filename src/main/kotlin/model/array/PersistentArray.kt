package com.github.mihanizzm.model.array

import com.github.mihanizzm.model.PersistentCollection

/**
 * Персистентный массив с позиционным доступом.
 *
 * - Все операции «модификации» возвращают новый массив и не изменяют старый.
 * - Размер массива фиксирован и задаёт допустимый диапазон индексов ([0, size)).
 * - Конкретная реализация в проекте основана на алгоритме path copying поверх
 *   32‑арного сбалансированного дерева.
 */
interface PersistentArray<T> : PersistentCollection<T> {
    /**
     * Возвращает новую версию массива с записанным значением на позиции [index].
     *
     * Предусловие:
     * - `index in 0 until size`, иначе бросается [IllegalArgumentException].
     *
     * Постусловия и гарантии:
     * - Возвращается новый массив; исходный не изменяется.
     * - [size] новой версии совпадает с размером исходной.
     * - Значение [value] может быть `null`, что соответствует «пустой» ячейке.
     */
    fun set(index: Int, value: T?): PersistentArray<T>
}
